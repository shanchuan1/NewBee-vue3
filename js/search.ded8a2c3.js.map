{"version":3,"file":"js/search.ded8a2c3.js","mappings":"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","sources":["webpack://NewBee/./src/views/Search.vue","webpack://NewBee/./src/views/Search.vue?a55f"],"sourcesContent":["<template>\n  <div class=\"product-list-wrap\">\n    <div class=\"product-list-content\">\n      <header class=\"category-header wrap\">\n        <i class=\"nbicon nbfanhui\" @click=\"goBack\"></i>\n        <div class=\"header-search\">\n          <i class=\"nbicon nbSearch\"></i>\n          <input type=\"text\" class=\"search-title\" v-model=\"keyword\" @keyup.enter=\"getSearch\" />\n        </div>\n        <span class=\"search-btn\" @click=\"getSearch\">搜索</span>\n      </header>\n      <van-tabs type=\"card\" color=\"#1baeae\" @click=\"changeTab\">\n        <van-tab title=\"推荐\" name=\"\"></van-tab>\n        <van-tab title=\"新品\" name=\"new\"></van-tab>\n        <van-tab title=\"价格\" name=\"price\"></van-tab>\n      </van-tabs>\n    </div>\n\n\n    <div class=\"content\">\n      <van-pull-refresh v-model=\"refreshing\" @refresh=\"onRefresh\" class=\"product-list-refresh\">\n        <van-list v-model:loading=\"loading\" :finished=\"finished\"\n          :finished-text=\"productList.length ? '没有更多了' : '搜索想要的商品'\" @load=\"onLoad\" @offset=\"10\">\n          <!-- <p v-for=\"item in list\" :key=\"item\">{{ item }}</p> -->\n          <template v-if=\"productList.length\">\n            <div class=\"product-item\" v-for=\"(item, index) in productList\" :key=\"index\" @click=\"productDetail(item.goodsId)\">\n              <img :src=\"$filters.prefix(item.goodsCoverImg)\" />\n              <div class=\"product-info\">\n                <p class=\"name\">{{ item.goodsName }}</p>\n                <p class=\"subtitle\">{{ item.goodsIntro }}</p>\n                <span class=\"price\">￥ {{ item.sellingPrice }}</span>\n              </div>\n            </div>\n          </template>\n          <img class=\"empty\" v-else src=\"https://s.yezgea02.com/1604041313083/kesrtd.png\" alt=\"搜索\">\n        </van-list>\n      </van-pull-refresh>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { search } from '@/request/api'\n\nimport { reactive, toRefs } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nexport default {\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    const state = reactive({\n      keyword: route.query.keyword || '',\n      searchBtn: false,\n      seclectActive: false,\n      refreshing: false,\n      list: [],\n      loading: false,\n      finished: false,\n      productList: [],\n      totalPage: 0,\n      page: 1,\n      orderBy: ''\n    })\n\n    // onMounted(() => {\n    //   init()\n    // })\n\n    const init = async () => {\n      const { categoryId } = route.query\n      if (!categoryId && !state.keyword) {\n        // Toast.fail('请输入关键词')\n        state.finished = true\n        state.loading = false;\n        return\n      }\n      const { data, data: { list } } = await search({ pageNumber: state.page, goodsCategoryId: categoryId, keyword: state.keyword, orderBy: state.orderBy })\n      console.log(data);\n\n\n      state.productList = state.productList.concat(list)\n      state.totalPage = data.totalPage\n      state.loading = false;\n      if (state.page >= data.totalPage) state.finished = true\n    }\n\n    // 回退\n    const goBack = () => {\n      router.go(-1)\n    }\n\n    const productDetail = (id) => {\n      console.log(id);\n      // router.push({ path: `/product/${item.goodsId}` })\n      router.push({ path: '/product', query: { id: id } })\n    }\n\n    const getSearch = () => {\n      onRefresh()\n    }\n\n    const onLoad = () => {\n      if (!state.refreshing && state.page < state.totalPage) {\n        state.page = state.page + 1\n      }\n      if (state.refreshing) {\n        state.productList = [];\n        state.refreshing = false;\n      }\n      init()\n    }\n\n\n\n    // 下拉刷新\n    const onRefresh = () => {\n      state.refreshing = true\n      state.finished = false\n      state.loading = true\n      state.page = 1\n      onLoad()\n    }\n\n    const changeTab = (name) => {\n      console.log('name', name)\n      state.orderBy = name\n      onRefresh()\n    }\n\n    return {\n      ...toRefs(state),\n      goBack,\n      productDetail,\n      getSearch,\n      changeTab,\n      onLoad,\n      onRefresh\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n@import '../common/style/mixin';\n\n.product-list-content {\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100%;\n  z-index: 1000;\n  background: #fff;\n\n  .category-header {\n    .fj();\n    width: 100%;\n    height: 3.125rem;\n    line-height: 3.125rem;\n    padding: 0 .9375rem;\n    .boxSizing();\n    font-size: .9375rem;\n    color: #656771;\n    z-index: 10000;\n\n    &.active {\n      background: @primary;\n    }\n\n    .icon-left {\n      font-size: 1.5625rem;\n      font-weight: bold;\n    }\n\n    .header-search {\n      display: flex;\n      width: 76%;\n      height: 1.25rem;\n      line-height: 1.25rem;\n      margin: .625rem 0;\n      padding: .3125rem 0;\n      color: #232326;\n      background: #F7F7F7;\n      .borderRadius(1.25rem);\n\n      .nbSearch {\n        padding: 0 .3125rem 0 1.25rem;\n        font-size: 1.0625rem;\n      }\n\n      .search-title {\n        font-size: .75rem;\n        color: #666;\n        background: #F7F7F7;\n      }\n    }\n\n    .icon-More {\n      font-size: 1.25rem;\n    }\n\n    .search-btn {\n      height: 1.75rem;\n      margin: .5rem 0;\n      line-height: 1.75rem;\n      padding: 0 .3125rem;\n      color: #fff;\n      background: @primary;\n      .borderRadius(.3125rem);\n      margin-top: .625rem;\n    }\n  }\n}\n\n.content {\n  height: calc(~\"(100vh - 4.375rem)\");\n  overflow: hidden;\n  overflow-y: scroll;\n  margin-top: 4.875rem;\n}\n\n.product-list-refresh {\n  .product-item {\n    .fj();\n    width: 100%;\n    height: 7.5rem;\n    padding: .625rem 0;\n    border-bottom: .0625rem solid #dcdcdc;\n\n    img {\n      width: 8.75rem;\n      height: 7.5rem;\n      padding: 0 .625rem;\n      .boxSizing();\n    }\n\n    .product-info {\n      width: 56%;\n      height: 7.5rem;\n      padding: .3125rem;\n      text-align: left;\n      .boxSizing();\n\n      p {\n        margin: 0\n      }\n\n      .name {\n        width: 100%;\n        max-height: 2.5rem;\n        line-height: 1.25rem;\n        font-size: .9375rem;\n        color: #333;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      .subtitle {\n        width: 100%;\n        max-height: 1.25rem;\n        padding: .625rem 0;\n        line-height: 1.5625rem;\n        font-size: .8125rem;\n        color: #999;\n        overflow: hidden;\n      }\n\n      .price {\n        color: @primary;\n        font-size: 1rem;\n      }\n    }\n  }\n\n  .empty {\n    display: block;\n    width: 9.375rem;\n    margin: 3.125rem auto 1.25rem;\n  }\n}\n</style>\n","import { render } from \"./Search.vue?vue&type=template&id=895515d8&scoped=true\"\nimport script from \"./Search.vue?vue&type=script&lang=js\"\nexport * from \"./Search.vue?vue&type=script&lang=js\"\n\nimport \"./Search.vue?vue&type=style&index=0&id=895515d8&lang=less&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\大娱乐家\\\\Desktop\\\\h5-master\\\\code-vue3\\\\NewBee-vue3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-895515d8\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","src","alt","_createElementBlock","onClick","$setup","_hoisted_5","type","_ctx","$event","onKeyup","_createVNode","_component_van_tabs","color","_component_van_tab","title","name","_component_van_pull_refresh","onRefresh","_component_van_list","loading","finished","length","onLoad","onOffset","_Fragment","key","_renderList","item","index","goodsId","prefix","goodsCoverImg","_toDisplayString","goodsName","goodsIntro","sellingPrice","setup","route","useRoute","router","useRouter","state","reactive","keyword","query","searchBtn","seclectActive","refreshing","list","productList","totalPage","page","orderBy","init","async","categoryId","data","search","pageNumber","goodsCategoryId","console","log","concat","goBack","go","productDetail","id","push","path","getSearch","changeTab","toRefs","__exports__","render"],"sourceRoot":""}